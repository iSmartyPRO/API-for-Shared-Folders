# Краткое описание
Приложение для управления сетевыми папками

# Как установить
```
git clone https://github.com/iSmartyPRO/API-for-Shared-Folders.git shared-folder-api
cd shared-folder-api
npm install
```

Скопируйте файл конфигурации из шаблона и заполните своими данными:
```
./config/index-sample.js ./config/index.js
```

# Запукс проекта

В режиме разработки:
```
npm run dev
```

Запуск в качестве службы на Windows:
```
npm run install
```

Остановка и удаление службы Windows:
```
npm run uninstall
```


# Сопутствующие проблемы при разработке и пути их решения
Последняя версия модуля node_windows не могла создавать службы, потому как отсутствовал зависимый модуль @author.io/args
В качестве решения, использовалась предыдущая версия node_windows 1.0.0-beta.6

При инъекции команды PowerShell на удаленном компьютере русская кодировка меняется
Русский язык нужен потому как используется описание на русском языка и самок главное на ОС с русскис языком нужно прописывать - Все в разрешениях.
Для решения проблем с кодировкой необходимо было использовать функции, которые доступны в Интернете, которые конвертируют строки. К сожалению у меня не получилось приспособить его в этом проекте.
Теперь как альтернативный вариант, конвертировать строки средствами библиотек NodeJS - нашёл iconv

При установке iconv выяснилось что нужны дополнительные системные зависимости такие как:
* python
* visual studio

Установил при помощи chocolatey:
```
cinst python
cinst visualstudio2019community
cinst visualstudio2017community
cinst visualstudio2019-workload-nativedesktop

```

вышеуказанные действия думаю, не актуальны. Оставляю для истории.

В итоге для решения задачи с кодировкой надо было обновить значение в реестре:
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Nls\CodePage

обновить OEMCP на 65001

и перезагрузить компьютер для применения настроек


По умолчанию служба запускается от системной учетной записи, для того чтобы было меньше ошибок в совместимости доступов можно использовать учетную запись администратора, для этого вручную надо обновить запуск службы через services.msc и перезагрузить службу.